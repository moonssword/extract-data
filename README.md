# üìÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Google Vision API –∏ OpenAI GPT-4o

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ç–µ–∫—Å—Ç –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ PDF-–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é Google Cloud Vision API, –∞ –∑–∞—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é OpenAI GPT-4o. 

---
## üìå –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
‚úÖ **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ `data/`** (PDF, JPG, PNG)
‚úÖ **PDF –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ JPG –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π**
‚úÖ **–†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å –ø–æ–º–æ—â—å—é Google Vision API**
‚úÖ **–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é OpenAI GPT-4o**
‚úÖ **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `output/output_{datetime}.json`**

---
## üõ† –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

- **Node.js** (v16+)
- **–ê–∫–∫–∞—É–Ω—Ç Google Cloud —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º Vision API**
- **API-–∫–ª—é—á OpenAI** (GPT-4o)
- **PDF-Poppler** (–¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ PDF –≤ JPG)
- **–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `npm install`)**:
  - `axios`
  - `dotenv`
  - `fs`
  - `path`
  - `pdf-poppler`
  - `@google-cloud/vision`

---
## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
### 1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```sh
npm install
```

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sh
npm install axios dotenv fs path pdf-poppler @google-cloud/vision
```

### 2Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PDF-Poppler
PDF-Poppler —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ PDF –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–π –û–°:

**Windows:**
1. –°–∫–∞—á–∞–π—Ç–µ [Poppler for Windows](https://github.com/oschwartz10612/poppler-windows/releases)
2. –†–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä—É–π—Ç–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—É—Ç—å –∫ `bin/` –≤ —Å–∏—Å—Ç–µ–º–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PATH`

**Linux (Debian/Ubuntu):**
```sh
sudo apt update && sudo apt install poppler-utils
```

**MacOS:**
```sh
brew install poppler
```

### 3Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ API-–∫–ª—é—á–∏
–°–æ–∑–¥–∞–π—Ç–µ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ —Ñ–∞–π–ª **`.env`** –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç—É–¥–∞:

```
GOOGLE_APPLICATION_CREDENTIALS=service-account.json
OPENAI_API_KEY=your-openai-api-key
```


### 4Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É `data/` –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–µ—ë —Ñ–∞–π–ª—ã —Ñ–æ—Ä–º–∞—Ç–æ–≤ **PDF, JPG, PNG**.

---
## üöÄ –ó–∞–ø—É—Å–∫

```sh
node script.js
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ `data/` –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `output/output_{datetime}.json`.

---
## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
üìÅ –ø—Ä–æ–µ–∫—Ç
 ‚îú‚îÄ‚îÄ üìÅ data            # –í—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã (PDF, JPG, PNG)
 ‚îú‚îÄ‚îÄ üìÅ output          # –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã (JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏)
 ‚îú‚îÄ‚îÄ üìÑ script.js       # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
 ‚îú‚îÄ‚îÄ üìÑ .env            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å API-–∫–ª—é—á–∞–º–∏
 ‚îú‚îÄ‚îÄ üìÑ service-account.json # –ö–ª—é—á Google Cloud Vision API
 ‚îú‚îÄ‚îÄ üìÑ package.json    # –§–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π npm
 ‚îú‚îÄ‚îÄ üìÑ README.md       # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
```

---
## üìä –í—ã—Ö–æ–¥–Ω–æ–π JSON

–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:

```json
[
  {
    "invoice_number": "14520766",
    "container_number": "BU8183503",
    "forwarder_name": "–ö–ó–• AO KTZ Express",
    "source_file": "example.pdf"
  }
]
```

---
## ‚ùì –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

### ‚ùå `–û—à–∏–±–∫–∞ OpenAI API: Unexpected token ...`
üí° **–†–µ—à–µ–Ω–∏–µ:** GPT-4o –∏–Ω–æ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON –≤ –∫–æ–¥-–±–ª–æ–∫–∞—Ö. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
```javascript
response.data.choices[0].message.content.replace(/^```json\s*|```$/g, "").trim()
```

### ‚ùå `Error: 7 PERMISSION_DENIED`
üí° **–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Google Cloud Vision API –≤–∫–ª—é—á–µ–Ω –∏ –≤–∞—à API-–∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.

### ‚ùå `Error: ENOENT: no such file or directory, open 'service-account.json'`
üí° **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `service-account.json` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —É–∫–∞–∑–∞–Ω –≤ `.env`.

### ‚ùå `Error: poppler-utils not found`
üí° **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PDF-Poppler —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ `PATH`.

